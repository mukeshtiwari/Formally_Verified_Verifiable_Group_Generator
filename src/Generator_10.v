Require Import Coq.NArith.NArith
  Verigen.Domainpar
  Znumtheory Lia
  Zdiv Zpow_facts.
From Coq Require Import String Ascii.
Open Scope N_scope.





(* 3072 bit prime*)

Module Pins <: Prime. 

Definition p : N := 0xc6e8592e81aa970e35cf903e0f45fed5b813655c3f5e8aae3ba77c680b7bf8fedcb90401d883fae744888195a64e6984ed82d3727a002fb4fff4409d0bb4591770910398470e58665b0c4afaadb7cde37890f2b80ed77ed1f7879d92f4f4af185aa09e8a4f1d240b63214bd83796afe5697c019157df6cddbc48c4c1e9fcbb0d3d14cc1c1de9a56286f07f3cb6fbad9211b39d594ea90081ff9cbf00ea6879bcbbbc33012d67191a4f0224cc80fba5a72e992d3abc92885e5f2dc01a7e64d73d4c284e70923159791043dc91d96060cde0a850a43bc99fd1f35747a10f10e685a93b7066e241d169ed6b5131a6753ed8c77a313718b181a0d41e46c75afef7eab39510095acd8fe54115cac184ab8e4e951f9568c7e304c9c258eb682c1fbe0cc2955055b920e215912c3b3ea357a58c0bf176d74a7af3baaf289a71032ab8ce6923031e8d83d6fced900e43aee54e65fadc983bcabb12bd050362b6a76891aa7219e6797835be0112c8240e46ca3b58cb45c31af8aa5f297e13c720b55051df.
Definition q : N := 0xe7a00236ce189705edadcb3b6a1d3da9af75c19c4c23170131af7745b79922cb.
Definition domain_parameter_seed : N := 0x3505ab042b4288395c0b640c6507b37790780ab69c933cac3618e5e92f29544d.
Definition index : N := 0x90.
Definition k : N := Eval vm_compute in N.div (p - 1) q.
Definition ggen : N := 0x6767656e.



Theorem prime_p : prime (Z.of_N p).
Proof.
Admitted.

Theorem p_len : 1024 <= N.size p.
Proof.
  simpl. lia.
Qed.

Theorem prime_q : prime (Z.of_N q).
Proof.
Admitted.

Theorem q_len : 160 <= N.size q.
Proof.
  simpl. lia.
Qed.

Theorem k_gteq_2 : 2 <= k.
Proof.
  vm_compute; intro Hf.
  inversion Hf.
Qed.

Theorem safe_prime : p = k * q + 1.
Proof.
  vm_compute.
  reflexivity.
Qed.

Theorem ggen_hyp : ggen =  0x6767656e.
Proof.
  unfold ggen.
  reflexivity.
Qed.

Theorem index_8bit : 0 <= index < 255.
Proof.
  vm_compute.
  split.
  intros Hf; inversion Hf.
  reflexivity.
Qed.


End Pins.


(* get a concrete instance *)
Module genr := Comp Pins.

Definition G : N := 0xbcec6cccca02b0a5d2445ebf850584d2d7193050a8fa619e435450ee34164a2cfe8247e101e8cef688d3a497f2aa79222ee247199d8a04f94f720ad68feb0f1b3c967e6b3772012b03606abae9197ad06c28d288b539ea1ffdf7de9a9e6ebeecbbf85d69b22abe639ab7fd3a3e1475c478c73e7d7ac25d3f9297c183e1e06071bd024c2eee62e6c6346e87910dd275c7b8c92014aed3a95c5a9d7c15d8c5c20d06f046a4630bc3a2fdf46e06b6346385c8e2b4b7cfbb152f58224c019816d52026e13f0568e245ecf41d37673283731dc796678efd134111c2f1e00ea9550a5e2f7eecd199173542a9c52193e929fb52f5b7a42d27680a3f34641691374ff5a3d251bfd856ddb0c14047ed55a2593283286e271b2c9922cb3e015aaf4ce63e10a07eabe2c1728378cc0c0874786f4407f90740081b48c9295fff6bf6afe81ab07c2332882445713b415d91925434cdda573c8cad4f7bb772cac27ff2f849f5970a7c86298a172bb3a8a27b5cfc8976ef190b244d2c27b846d743217df5c6bd15.


Theorem G_is_gen : genr.Valid G = genr.compute_generator.
Proof.
  Time vm_compute.
  reflexivity.
Qed.



Time Eval vm_compute in genr.compute_generator.

(*
Finished transaction in 1418.804 secs (1407.357u,10.235s) (successful)
	 = genr.Valid
         4287387900415874329539416709976769266459844797692946850755415061049853969319540434254000367372908561163305788123715331746181952931541577688878686605993064449816575775307400434277728575572844256140961810807167967475008910118050149173691595814863249029683210571233391135692095930504883097353773675029750447458648565889607516441739549398590419378630385561755690018707618481919584673291517946074890885633559908927469486214697952958610772113903851819749942559038101483475130120011622816821220963461713750348003626557633182785359819145157202281708787559969804326599766245155181476364432107381838847593953877465069492847591267620616534670348397979155312950958449441222674271271613478097938270718517831996227760019288273525360891505079303702445984462284560738211594759025717202810336102260198678784414582391155551558673657742352410700356853958784720389419009118656191948454137538595843290747283916485507903283505003679857626459847957
     : genr.Tag
Finished transaction in 0.832 secs (0.752u,0.059s) (successful)

*)


Time Eval vm_compute in (genr.verify_generator 4287387900415874329539416709976769266459844797692946850755415061049853969319540434254000367372908561163305788123715331746181952931541577688878686605993064449816575775307400434277728575572844256140961810807167967475008910118050149173691595814863249029683210571233391135692095930504883097353773675029750447458648565889607516441739549398590419378630385561755690018707618481919584673291517946074890885633559908927469486214697952958610772113903851819749942559038101483475130120011622816821220963461713750348003626557633182785359819145157202281708787559969804326599766245155181476364432107381838847593953877465069492847591267620616534670348397979155312950958449441222674271271613478097938270718517831996227760019288273525360891505079303702445984462284560738211594759025717202810336102260198678784414582391155551558673657742352410700356853958784720389419009118656191948454137538595843290747283916485507903283505003679857626459847957).

(*

= true
     : bool
Finished transaction in 1597.531 secs (1587.206u,9.855s) (successful)


*)