From Stdlib Require Import NArith
  Znumtheory Lia
  Zdiv Zpow_facts
  String Ascii.
From Verigen Require Import Domainpar
  Functions.
Open Scope N_scope.




(* 3072 bit prime*)

Module Pins <: Prime. 

Definition p : N := 0xf193a17e653086bf863236ff52f22db3c94be00b9469cbf61e28e619f4f7c9b748d0e54aeb0a80c49384ddb191aee5deea1d11ed3902d60a557b9ab8625870c482d6f35ad1583c2047b96828e2b709bd2faf6f76461a2a2fbd81c75d5b8aea73a0a5e80d0f7a3ac284ef60f026a8154ed792e0c225b8eee5e4f5eddf098ba297fdb2462548929a7fd3a4539d6b640b19822f804fd978d8aa5ee46b354bb575ad3cccda2fd01a18876bbcffb609ccde0344cadb75a1216e2dc0f18a2a241c9d13d7c2a96e23b7e2a9d5d5fdb3ef89cc55293d54f4308a6ee2e78666e827ccfb70454634213e6ee153df928a1ff52eb5ac87d6d4b3ced62433396191a66b2b3c2efeb84b1669f56e485792dff818d1c817b557a19205ef8bd42880cdbcb5f622c0a0b54557a9cb71618129aaf8abaa3c142bc6e49c991799742e91fe3f541b581d1899aaa9204122b6bc34fccaf5cd6e22d4aba7d95180e0e2aa5cbdb4f0e8edc81baed0d2901fbd26f173be36e0e2f5c952ef3ae958530610a7790338d4416913.
Definition q : N := 0xa581f1d4548661844f96250aa29b64397e49ab290c33ac3fc4aabb3cfcfd87a7.
Definition domain_parameter_seed : N := 0xbe1924d400ddc23913f7fe12894d135dc5954a408dc5fda46531137724309ce6.
Definition index : N := 0xab.
Definition k : N := Eval vm_compute in N.div (p - 1) q.
Definition ggen : N := 0x6767656e.



Theorem prime_p : prime (Z.of_N p).
Proof.
Admitted.

Theorem p_len : 1024 <= N.size p.
Proof.
  simpl. lia.
Qed.

Theorem prime_q : prime (Z.of_N q).
Proof.
Admitted.

Theorem q_len : 160 <= N.size q.
Proof.
  simpl. lia.
Qed.

Theorem k_gteq_2 : 2 <= k.
Proof.
  vm_compute; intro Hf.
  inversion Hf.
Qed.

Theorem safe_prime : p = k * q + 1.
Proof.
  vm_compute.
  reflexivity.
Qed.

Theorem ggen_hyp : ggen =  0x6767656e.
Proof.
  unfold ggen.
  reflexivity.
Qed.

Theorem index_8bit : 0 <= index < 255.
Proof.
  vm_compute.
  split.
  intros Hf; inversion Hf.
  reflexivity.
Qed.


End Pins.


(* get a concrete instance *)
Module genr := Comp Pins.

Definition G : N  := 0xe2980545d4f9f00b678baedaee12f59c224cd200f9aaac65a407046c7e246973348dcb5ec7035fb35923a259fe1f76f7cf3b9084d168ee81b7a23e4ccb1322240cfa47c2130886dde6e86a13a695c1f4fce47396d1006af07af744d8f72fcb56e6bed24d48f50370e8ca265ff03a41482b188ce9a70656bcbd46599df867a05fb29459c22af5c93faa67b05b3c0e3665f395e6d4a5f8e05d857642b027ae7a7ec5bd618b15b034ac66c8d3b3627c35dd863188002d623a8b91c5d7ab093437348a5020bd6f4080baf42e8cbd0733e1b4fad2197ce24973f25076c138af697effd7c1f35d64b061672b46cb7e802e3853ff9d0a5f900c887c60edc4d4d6f707db77555ae327a227ad403626a2a10474a5f43be25e56fa39d1aa05073329222d3eb7513b6a4a86501978171979792d9bab88ae2d8c7e48548f8a7dfe0a70423e6f9a0ab2b7e30b12454cf946175c9ba90c5209aa0980eeb7bb4b6d4c08f56d13cb63e3cc350ca3fe00bb9aaf936a74a1211b10c5cf0ee4f623ba025647d3cac071.


Theorem G_is_gen : genr.Valid G = genr.compute_generator.
Proof.
  Time vm_compute.
  reflexivity.
Qed.



Time Eval vm_compute in genr.compute_generator.

Time Eval vm_compute in (genr.verify_generator 5142269046611298751053334471712018380952381659994149061069643310780863411117756830385169625171306902268731945265611175832982085711414921325430792621067001642054430322541316695452318115167970016625546426097672467620839422473921709026039725510992923909031023192174059668984872166791847785098121010517945765446961570007177822942898941331888153276962092525360573272974634978013864168046512739478574948414329466141821447534309755925230066981468451347043551719324995849899067726237010049836515585927730058820192474169847466483361570985526862054236113750881396542483192524341448209408531022129289703356623973794545446814225059247328981961060656844942121203760003864474654437004736370165730970677136513883966628087789535547496889264530799006158784007444380513118730444715144564668024953057128445187848415738918976578866440346949147032367775690198477927956647715787727147792313887321249651999990491718645651559760096877183540600160369).

(*

Finished transaction in 1483.557 secs (1482.168u,1.214s) (successful)
Finished transaction in 1479.475 secs (1478.121u,1.187s) (successful)
	 = genr.Valid
         5142269046611298751053334471712018380952381659994149061069643310780863411117756830385169625171306902268731945265611175832982085711414921325430792621067001642054430322541316695452318115167970016625546426097672467620839422473921709026039725510992923909031023192174059668984872166791847785098121010517945765446961570007177822942898941331888153276962092525360573272974634978013864168046512739478574948414329466141821447534309755925230066981468451347043551719324995849899067726237010049836515585927730058820192474169847466483361570985526862054236113750881396542483192524341448209408531022129289703356623973794545446814225059247328981961060656844942121203760003864474654437004736370165730970677136513883966628087789535547496889264530799006158784007444380513118730444715144564668024953057128445187848415738918976578866440346949147032367775690198477927956647715787727147792313887321249651999990491718645651559760096877183540600160369
     : genr.Tag
Finished transaction in 1490.535 secs (1488.985u,1.676s) (successful)
	 = true
     : bool
*)
