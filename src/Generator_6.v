From Stdlib Require Import NArith
  Znumtheory Lia
  Zdiv Zpow_facts
  String Ascii.
From Verigen Require Import Domainpar
  Functions.
Open Scope N_scope.



(* 2048 bit prime*)

Module Pins <: Prime. 

Definition p : N := 0xd9935378bfddbc282b937772bcd9d79687f6eb4a06c564518e7f7fabd2a0ec2606a88994a53557a31fcdcae6cb2cc49c852a1e5925207aeebaaa4b2508aae1ca857dc0d4a4c3f341c71162802c5e4646a1d44ff9e911fb48051eb4483d71cc9842aac72bd48a22211fbe906c5249d308624a66745ea2574dd5a445e6d6a65ce0a802d2990c64c82fc9c067faef6cfc0a4102ca28266301d2f9b50b1e2c366ed06ac2b3700c8daff1ee9ee1fea43ac009910714fa581bae694dd972472933bbff2a84ca6b764e48b5d19c3322c3810662fc4eb44d9223fb26ece229c60acb60c8003bccd40cc6bc5346d0a7a9e9c672e5773127ca53fa1185c464dafff532c903.
Definition q : N := 0xe707fdb1703939b6e67a45321975eba0b4fa3b3f6787a0779504d16b.
Definition domain_parameter_seed : N := 0x67e69e166a1a3781c407f610023ee8345c0f23d57a89b5a2c6178a41.
Definition index : N := 0x62.
Definition k : N := Eval vm_compute in N.div (p - 1) q.
Definition ggen : N := 0x6767656e.



Theorem prime_p : prime (Z.of_N p).
Proof.
Admitted.

Theorem p_len : 1024 <= N.size p.
Proof.
  simpl. lia.
Qed.

Theorem prime_q : prime (Z.of_N q).
Proof.
Admitted.

Theorem q_len : 160 <= N.size q.
Proof.
  simpl. lia.
Qed.

Theorem k_gteq_2 : 2 <= k.
Proof.
  vm_compute; intro Hf.
  inversion Hf.
Qed.

Theorem safe_prime : p = k * q + 1.
Proof.
  vm_compute.
  reflexivity.
Qed.

Theorem ggen_hyp : ggen =  0x6767656e.
Proof.
  unfold ggen.
  reflexivity.
Qed.

Theorem index_8bit : 0 <= index < 255.
Proof.
  vm_compute.
  split.
  intros Hf; inversion Hf.
  reflexivity.
Qed.


End Pins.


(* get a concrete instance *)
Module genr := Comp Pins.

Definition G : N := 0x86aaaacb34378863b81b254f414784d9fd813daaf381fc1f5a34641d479310b091cd4c7bff495a169b1450b1b9ba0cdf74a836955284a2219e98ea9d0c999c74d1a2402519e622b6b049b7f54cc85d8a179f5f7925cc5c494111094d800e1817df49763027e5d2579c47893e5498cbfb8c082eac156e0496719cd1059df96b60b9bb9df65aede79d0b27639934700b6c279168ca42e5976914d257634efd9357168af5681aeb6bb4c499fb9b3c6ecd94d679c378de6ba960113071741c9fe01df59ba59d2ce35a97eaf0e34f376ed82b47b346a3191a4de09714be0b003044a7d9fe780240afe25fbd66357d554542d11c37d364bb4b55dff6d8e7b2672d5463.

Theorem G_is_gen : genr.Valid G = genr.compute_generator.
Proof.
  Time vm_compute.
  reflexivity.
Qed.

Time Eval vm_compute in genr.compute_generator.

(*
Finished transaction in 415.007 secs (412.898u,2.035s) (successful)
	 = genr.Valid
         17000091980252583428757806982638937856245893569533792216699813468191566634688128634050776893335947220947031435842901649795772466193775260976330643619179865466997471285306413279441538541328081656290102268160274755294414079471402076954782591372589274675093571750842213809016165031347652847970867397746301688224983069772073832490178172576260017477008355450432674058720853288885702484954444657071164813330071988886337091404537365227283011682049166650944586632286313933806893049897200661578473701190683228555851424768513111930423324951216677475160773117624980727524747216080485677785692737362530025677011447036821713540195
     : genr.Tag
Finished transaction in 0.348 secs (0.343u,0.004s) (successful)

*)

Time Eval vm_compute in (genr.verify_generator
17000091980252583428757806982638937856245893569533792216699813468191566634688128634050776893335947220947031435842901649795772466193775260976330643619179865466997471285306413279441538541328081656290102268160274755294414079471402076954782591372589274675093571750842213809016165031347652847970867397746301688224983069772073832490178172576260017477008355450432674058720853288885702484954444657071164813330071988886337091404537365227283011682049166650944586632286313933806893049897200661578473701190683228555851424768513111930423324951216677475160773117624980727524747216080485677785692737362530025677011447036821713540195).

(*
= true
     : bool
Finished transaction in 490.422 secs (486.945u,3.229s) (successful)

*)