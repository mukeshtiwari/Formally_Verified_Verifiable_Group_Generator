From Stdlib Require Import NArith
  Znumtheory Lia
  Zdiv Zpow_facts
  String Ascii.
From Verigen Require Import Domainpar
  Functions.
Open Scope N_scope.





(* 2048 bit prime*)

Module Pins <: Prime. 

Definition p : N := 0xd6c4e5045697756c7a312d02c2289c25d40f9954261f7b5876214b6df109c738b76226b199bb7e33f8fc7ac1dcc316e1e7c78973951bfc6ff2e00cc987cd76fcfb0b8c0096b0b460fffac960ca4136c28f4bfb580de47cf7e7934c3985e3b3d943b77f06ef2af3ac3494fc3c6fc49810a63853862a02bb1c824a01b7fc688e4028527a58ad58c9d512922660db5d505bc263af293bc93bcd6d885a157579d7f52952236dd9d06a4fc3bc2247d21f1a70f5848eb0176513537c983f5a36737f01f82b44546e8e7f0fabc457e3de1d9c5dba96965b10a2a0580b0ad0f88179e10066107fb74314a07e6745863bc797b7002ebec0b000a98eb697414709ac17b401.
Definition q : N := 0xb1e370f6472c8754ccd75e99666ec8ef1fd748b748bbbc08503d82ce8055ab3b.
Definition domain_parameter_seed : N := 0x6f23af696fa2ae906154295dcdd8b83bb0fde9d9332416333b1e55000d92927b.
Definition index : N := 0x12.
Definition k : N := Eval vm_compute in N.div (p - 1) q.
Definition ggen : N := 0x6767656e.



Theorem prime_p : prime (Z.of_N p).
Proof.
Admitted.

Theorem p_len : 1024 <= N.size p.
Proof.
  simpl. lia.
Qed.

Theorem prime_q : prime (Z.of_N q).
Proof.
Admitted.

Theorem q_len : 160 <= N.size q.
Proof.
  simpl. lia.
Qed.

Theorem k_gteq_2 : 2 <= k.
Proof.
  vm_compute; intro Hf.
  inversion Hf.
Qed.

Theorem safe_prime : p = k * q + 1.
Proof.
  vm_compute.
  reflexivity.
Qed.

Theorem ggen_hyp : ggen =  0x6767656e.
Proof.
  unfold ggen.
  reflexivity.
Qed.

Theorem index_8bit : 0 <= index < 255.
Proof.
  vm_compute.
  split.
  intros Hf; inversion Hf.
  reflexivity.
Qed.


End Pins.


(* get a concrete instance *)
Module genr := Comp Pins.
Definition G : N := 0x9a8269ab2e3b733a5242179d8f8ddb17ff93297d9eab00376db211a22b19c854dfa80166df2132cbc51fb224b0904abb22da2c7b7850f782124cb575b116f41ea7c4fc75b1d77525204cd7c23a15999004c23cdeb72359ee74e886a1dde7855ae05fe847447d0a68059002c3819a75dc7dcbb30e39efac36e07e2c404b7ca98b263b25fa314ba93c0625718bd489cea6d04ba4b0b7f156eeb4c56c44b50e4fb5bce9d7ae0d55b379225feb0214a04bed72f33e0664d290e7c840df3e2abb5e48189fa4e90646f1867db289c6560476799f7be8420a6dc01d078de437f280fff2d7ddf1248d56e1a54b933a41629d6c252983c58795105802d30d7bcd819cf6ef.

Theorem G_is_gen : genr.Valid G = genr.compute_generator.
Proof.
  Time vm_compute.
  reflexivity.
Qed.

Time Eval vm_compute in genr.compute_generator.

(*
Finished transaction in 410.214 secs (407.12u,2.878s) (successful)
	 = genr.Valid
         19505007897628087214258470741983733303993129606909771160933535007624517213905478669883399507508368338521633288116655756851871582957570975665522208849109692771478416189849647516623601185277096525404613089202268761028314488416628441521995648895965894383947550057509046815947139230214991308459417898812040648095362629463239815796837419841946171750790842682733367933794859041951588095792472952772187723597083481033010341517250868974535354067787123216189678903435534409554938991048675677096549033814900474097699209573422225276935134621669497733391117821219447658975257788692574807159800602790330174406663975472198869382895
     : genr.Tag
Finished transaction in 0.353 secs (0.348u,0.005s) (successful)
*)

Time Eval vm_compute in (genr.verify_generator 19505007897628087214258470741983733303993129606909771160933535007624517213905478669883399507508368338521633288116655756851871582957570975665522208849109692771478416189849647516623601185277096525404613089202268761028314488416628441521995648895965894383947550057509046815947139230214991308459417898812040648095362629463239815796837419841946171750790842682733367933794859041951588095792472952772187723597083481033010341517250868974535354067787123216189678903435534409554938991048675677096549033814900474097699209573422225276935134621669497733391117821219447658975257788692574807159800602790330174406663975472198869382895).

(*
 = true
     : bool
Finished transaction in 494.266 secs (489.939u,4.089s) (successful)

*)